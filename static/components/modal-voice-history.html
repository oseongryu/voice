<!-- 음성 히스토리 팝업 모달 (Bootstrap) -->
<div class="modal fade" id="voiceHistoryModal" tabindex="-1" aria-labelledby="voiceHistoryModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-xl">
        <div class="modal-content">
            <div class="modal-header" style="padding: 0.5rem 1rem;">
                <h6 class="modal-title" id="voiceHistoryModalLabel" style="font-size: 0.95rem;">🎤 음성 히스토리</h6>
                <button type="button" class="btn-close btn-sm" data-bs-dismiss="modal" aria-label="Close"
                    style="font-size: 0.8rem;"></button>
            </div>
            <div class="modal-body">
                <!-- 텍스트 입력 섹션 -->
                <div class="text-input-section mb-3">
                    <div class="input-group">
                        <input type="text" id="voiceTextInput" class="form-control"
                            placeholder="텍스트를 입력하고 Enter를 누르거나 추가 버튼을 클릭하세요..." />
                        <button id="voiceAddTextBtn" class="btn btn-primary" onclick="addTextToVoiceHistory()">
                            추가
                        </button>
                    </div>
                </div>

                <!-- 음성 및 제어 버튼 -->
                <div class="voice-controls d-flex flex-wrap gap-2 mb-3">
                    <button id="voiceRequestPermissionBtn" class="btn btn-outline-secondary btn-sm"
                        onclick="requestVoiceMicrophonePermission()">
                        🎤 마이크 권한
                    </button>
                    <button id="voiceRecordBtn" class="btn btn-danger btn-sm" onclick="startVoiceRecording()">
                        음성녹음
                    </button>
                    <button id="voiceStopBtn" class="btn btn-dark btn-sm" onclick="stopVoiceRecording()"
                        style="display: none">
                        녹음중지
                    </button>
                    <button id="voiceRefreshHistoryBtn" class="btn btn-secondary btn-sm"
                        onclick="loadVoiceServerHistory()">
                        새로고침
                    </button>
                    <button id="voiceSelectAllBtn" class="btn btn-outline-secondary btn-sm"
                        onclick="selectAllVoiceHistory()">
                        전체선택
                    </button>
                    <button id="voiceCopySelectedBtn" class="btn btn-outline-secondary btn-sm"
                        onclick="copySelectedVoiceHistory()">
                        선택복사
                    </button>
                    <button id="voiceCopyToServerBtn" class="btn btn-outline-primary btn-sm"
                        onclick="copySelectedToServerClipboard()">
                        서버복사
                    </button>
                    <button id="voiceExecuteSelectedBtn" class="btn btn-success btn-sm"
                        onclick="executeSelectedVoiceHistory()">
                        실행
                    </button>
                    <button id="voiceDeleteSelectedBtn" class="btn btn-danger btn-sm"
                        onclick="deleteSelectedVoiceHistory()" style="display: none">
                        선택삭제
                    </button>
                    <button id="voiceClearServerHistoryBtn" class="btn btn-outline-danger btn-sm"
                        onclick="clearVoiceServerHistory()">
                        전체삭제
                    </button>
                    <button id="voiceExportHistoryBtn" class="btn btn-outline-secondary btn-sm"
                        onclick="exportVoiceHistory()">
                        내보내기
                    </button>
                </div>

                <!-- 히스토리 카운터 -->
                <div class="mb-2 text-muted">
                    음성 변환 히스토리 <span id="voiceHistoryCounter">(총 0개)</span>
                </div>

                <!-- 히스토리 그리드 -->
                <div id="voiceGridContainer" class="ag-theme-alpine"
                    style="height: 400px; width: 100%; border: 1px solid #ddd; border-radius: 4px">
                    <div class="loading-history d-flex align-items-center justify-content-center h-100 text-muted">
                        <div class="spinner-border spinner-border-sm me-2" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        히스토리를 불러오는 중...
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>